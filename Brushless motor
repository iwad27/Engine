#include <Servo.h>
const int escPin = 3;
int min_throttle = 1000;
int max_throttle = 2000;
unsigned long currentMillis, previousMillis;
void setup() {
 Serial.begin(9600);
 Serial.println(F("Initialize System"));
 pinMode(escPin, OUTPUT);
 initProcedure();
}
void loop() {
 runBrushless();
}
void runBrushless() { /* function runBrushless */
 Serial.println("running");
 currentMillis = 0;
 previousMillis = millis();
 while (currentMillis < 2000) {
   currentMillis = millis() - previousMillis;
   digitalWrite(escPin, HIGH);
   delayMicroseconds(1350);
   digitalWrite(escPin, LOW);
   delay(20);
 }
 Serial.println("stop");
 currentMillis = 0;
 previousMillis = millis();
 while (currentMillis < 2000) {
   currentMillis = millis() - previousMillis;
   digitalWrite(escPin, HIGH);
   delayMicroseconds(min_throttle);
   digitalWrite(escPin, LOW);
   delay(20);
 }
}
void initProcedure() { /* function initProcedure */
 previousMillis = millis();
 Serial.println("throttle up");
 while (currentMillis < 3000) {
   currentMillis = millis() - previousMillis;
   Serial.println(currentMillis);
   digitalWrite(escPin, HIGH);
   delayMicroseconds(max_throttle);
   digitalWrite(escPin, LOW);
   delay(20);
 }
 currentMillis = 0;
 previousMillis = millis();
 Serial.println("throttle down");
 while (currentMillis < 4500) {
   currentMillis = millis() - previousMillis;
   Serial.println(currentMillis);
   digitalWrite(escPin, HIGH);
   delayMicroseconds(min_throttle);
   digitalWrite(escPin, LOW);
   delay(20);
 }
}
